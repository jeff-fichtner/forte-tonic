<script>
    class Display {
        constructor() { }

        initialize = () => {
            document.addEventListener('DOMContentLoaded', () => {
                this.initTabs();
            });
        };

        initTabs() {
            const tabsContainer = document.querySelector('.tabs');
            const tabs = document.querySelectorAll('.tabs .tab a');
            const tabContents = document.querySelectorAll('.tab-content');

            if (!tabsContainer || tabs.length === 0) return;

            tabs.forEach((tab) => {
                tab.addEventListener('click', (event) => {
                    event.preventDefault();
                    const targetTab = tab.getAttribute('href');
                    const targetContent = document.querySelector(targetTab);

                    // Hide all tab contents
                    tabContents.forEach((content) => {
                        content.style.display = 'none';
                    });

                    // Show the selected tab content
                    if (targetContent) {
                        targetContent.style.display = 'block';
                    }

                    // Remove active class from all tabs and add it to the clicked tab
                    tabs.forEach((t) => t.classList.remove('active'));
                    tab.classList.add('active');
                });
            });

            // Show the first tab and its content by default
            if (tabs.length > 0) {
                tabs[0].click();
            }
        }

        setLoading(isLoading) {
            const loadingElement = document.getElementById('loading');
            const tablesElement = document.getElementById('tables');
            const errorMessageElement = document.getElementById('error-message');

            loadingElement.style.display = isLoading ? 'block' : 'none';
            tablesElement.style.display = isLoading ? 'none' : 'block';
            errorMessageElement.style.display = 'none'; // Hide error message when loading
        }

        showErrorMessage(message) {
            const errorMessageElement = document.getElementById('error-message');
            const tablesElement = document.getElementById('tables');

            errorMessageElement.textContent = message;
            errorMessageElement.style.display = 'block';
            tablesElement.style.display = 'none';
        }

        updateTableAndMessage(tbodyId, emptyMessageId, data, valueExtractor) {
            const tbody = document.getElementById(tbodyId);
            const emptyMessage = document.getElementById(emptyMessageId);
            const table = tbody.closest('table');

            tbody.innerHTML = '';

            if (data.length === 0) {
                emptyMessage.hidden = false;
                table.hidden = true;
            } else {
                emptyMessage.hidden = true;
                table.hidden = false;

                data.forEach((item) => {
                    const row = document.createElement('tr');
                    valueExtractor(item).forEach((value) => {
                        const cell = document.createElement('td');
                        cell.textContent = value;
                        row.appendChild(cell);
                    });
                    tbody.appendChild(row);
                });
            }
        }

        setInstructors(instructors) {
            this.updateTableAndMessage(
                'instructors-tbody',
                'instructors-empty-message',
                instructors,
                (instructor) => [instructor.fullName, instructor.email, instructor.instrument1]
            );
        }

        // setStudents(students) {
        //     this.updateTableAndMessage(
        //         'students-tbody',
        //         'students-empty-message',
        //         students,
        //         (student) => {debugger}//[`${student.firstName} ${student.lastName}`, student.studentId, student.grade]
        //     );
        // }

        // setClasses(classes) {
        //     this.updateTableAndMessage(
        //         'classes-tbody',
        //         'classes-empty-message',
        //         classes,
        //         (classItem) => [classItem.formattedName, classItem.instructor.fullName, classItem.day]
        //     );
        // }

        // setRegistrations(registrations) {
        //     this.updateTableAndMessage(
        //         'registrations-tbody',
        //         'registrations-empty-message',
        //         registrations,
        //         (registration) => [`${registration.student.firstName} ${registration.student.lastName}`, registration.room.formattedName, registration.date]
        //     );
        // }

        getCurrentTab() {
            const activeTab = document.querySelector('.tabs .tab a.active');
            return activeTab ? activeTab.getAttribute('id') : null;
        }
    }
</script>