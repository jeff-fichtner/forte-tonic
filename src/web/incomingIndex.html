<!DOCTYPE html>
<html>

<head>
  <?!= include('web/css/libraries'); ?>
  <?!= include('web/js/libraries'); ?>
  <?!= include('web/js/includes'); ?>
  <style>
    li.delete-lesson-icon,
    li.add-lesson-icon {
      cursor: pointer;
    }
  </style>
  <script>
    const ServerFunctions = {
      getAuthenticatedUser: 'getAuthenticatedUser',
      getInstructors: 'getInstructors',
      getStudents: 'getStudents',
      getClasses: 'getClasses',
      getRegistrations: 'getRegistrations',
      getRooms: 'getRooms'
    };

    (async () => {
      const display = new Display();

      try {
        const [
          initializeDisplay_,
          authenticatedUser,
          allInstructors,
          // allStudents,
          // allClasses,
          // allRegistrations,
          // allRooms
        ] =
          await Promise.all([
            TaskHelpers.promisify(() => display.initialize())(),
            HttpClient.fetch(ServerFunctions.getAuthenticatedUser, x => new AuthenticatedUserResponse(x)),
            HttpClient.fetchAllPages(ServerFunctions.getInstructors, x => new Instructor(x)),
            // fetchAllPages(ServerFunctions.getStudents),
            // fetchAllPages(ServerFunctions.getClasses, x => new Class(x)),
            // fetchAllPages(ServerFunctions.getRegistrations, x => new Registration(x)),
            // fetchAllPages(ServerFunctions.getRooms, x => new Room(x))
          ]);

        display.setInstructors(allInstructors);
        // display.setStudents([]); // allStudents);
        // display.setClasses(allClasses, allInstructors);
        // display.setRegistrations(allRegistrations, [] /* allStudents */, allInstructors, allRooms);
        // display.setRooms(allRooms);
        display.setLoading(false);

      } catch (error) {
        console.error(error);
        display.showErrorMessage(`An error occurred while loading data: ${error.message}`);
      }
    })();
  </script>
</head>

<body>
  <div class="container">
    <h1>Tonic</h1>

    <div class="valign-wrapper">
      <div id="loading" class="preloader-wrapper big active center-align">
        <div class="spinner-layer spinner-blue">
          <div class="circle-clipper left">
            <div class="circle"></div>
          </div>
          <div class="gap-patch">
            <div class="circle"></div>
          </div>
          <div class="circle-clipper right">
            <div class="circle"></div>
          </div>
        </div>

        <div class="spinner-layer spinner-red">
          <div class="circle-clipper left">
            <div class="circle"></div>
          </div>
          <div class="gap-patch">
            <div class="circle"></div>
          </div>
          <div class="circle-clipper right">
            <div class="circle"></div>
          </div>
        </div>

        <div class="spinner-layer spinner-yellow">
          <div class="circle-clipper left">
            <div class="circle"></div>
          </div>
          <div class="gap-patch">
            <div class="circle"></div>
          </div>
          <div class="circle-clipper right">
            <div class="circle"></div>
          </div>
        </div>

        <div class="spinner-layer spinner-green">
          <div class="circle-clipper left">
            <div class="circle"></div>
          </div>
          <div class="gap-patch">
            <div class="circle"></div>
          </div>
          <div class="circle-clipper right">
            <div class="circle"></div>
          </div>
        </div>
      </div>
    </div>

    <div hidden id="tables" class="center-align">
      <ul class="tabs">
        <li class="tab"><a href="#instructors-tab">Instructors</a></li>
        <li class="tab"><a href="#students-tab">Students</a></li>
        <li class="tab"><a href="#classes-tab">Classes</a></li>
        <li class="tab"><a href="#registrations-tab">Registrations</a></li>
        <li class="tab"><a href="#rooms-tab">Rooms</a></li>
      </ul>
      <div id="instructors-tab" class="tab-content">
        <h2>Instructors</h2>
        <table hidden>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Instruments</th>
            </tr>
          </thead>
          <tbody id="instructors-tbody"></tbody>
        </table>
        <p id="instructors-empty-message" hidden>No instructors.</p>
        <div id="instructors-pagination" class="pagination-container"></div>
      </div>
      <div id="students-tab" class="tab-content">
        <h2>Students</h2>
        <table hidden>
          <thead>
            <tr>
              <th>Name</th>
              <th>Student ID</th>
              <th>Grade</th>
            </tr>
          </thead>
          <tbody id="students-tbody"></tbody>
        </table>
        <p id="students-empty-message" hidden>No students.</p>
        <div id="students-pagination" class="pagination-container"></div>
      </div>
      <div id="classes-tab" class="tab-content">
        <h2>Classes</h2>
        <table hidden>
          <thead>
            <tr>
              <th>Name</th>
              <th>Instructor</th>
              <th>Day</th>
            </tr>
          </thead>
          <tbody id="classes-tbody"></tbody>
        </table>
        <p id="classes-empty-message" hidden>No classes.</p>
        <div id="classes-pagination" class="pagination-container"></div>
      </div>
      <div id="registrations-tab" class="tab-content">
        <h2>Registrations</h2>
        <table hidden>
          <thead>
            <tr>
              <th>Student</th>
              <th>Instructor</th>
              <th>Room</th>
              <th>Instrument</th>
            </tr>
          </thead>
          <tbody id="registrations-tbody"></tbody>
        </table>
        <p id="registrations-empty-message" hidden>No registrations.</p>
        <div id="registrations-pagination" class="pagination-container"></div>
      </div>
      <div id="rooms-tab" class="tab-content">
        <h2>Rooms</h2>
        <table hidden>
          <thead>
            <tr>
              <th>Name</th>
            </tr>
          </thead>
          <tbody id="rooms-tbody"></tbody>
        </table>
        <p id="rooms-empty-message" hidden>No rooms.</p>
        <div id="rooms-pagination" class="pagination-container"></div>
      </div>
      <div id="error-message" hidden>An error occurred.</div>
    </div>
</body>

</html>